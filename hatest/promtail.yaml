server:
  http_listen_port: 9080
  grpc_listen_port: 0

positions:
  filename: /tmp/positions.yaml

clients:
  - url: ${HATEST_LOKI_URL}

scrape_configs:
- job_name: results
  static_configs:
  - targets:
      - localhost
    labels:
      job_name: ${HATEST_JOB_NAME}
      log: results
      __path__: ${HATEST_RESULTS_LOG}
  pipeline_stages:
  - logfmt:
      mapping:
        epoch: timestamp
  - timestamp:
      format: Unix
      source: timestamp  
- job_name: k6results
  static_configs:
  - targets:
      - localhost
    labels:
      job_name: ${HATEST_JOB_NAME}
      log: k6results
      __path__: ${HATEST_K6_RESULTS_LOG}
  pipeline_stages:
  - json:
      expressions:
        timestamp: data.time
  - timestamp:
      format: Unix
      source: timestamp  
- job_name: app
  static_configs:
  - targets:
      - localhost
    labels:
      job_name: ${HATEST_JOB_NAME}
      log: app
      __path__: ${HATEST_APP_LOG}
- job_name: job_meta
  static_configs:
  - targets:
      - localhost
    labels:
      job_name: ${HATEST_JOB_NAME}
      log: job_meta
      __path__: ${HATEST_JOB_META_LOG}
